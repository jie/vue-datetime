/*!
 * vue-datetime v1.0.0-beta.2
 * (c) 2018 Mario Ju√°rez
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("luxon")):"function"==typeof define&&define.amd?define(["exports","luxon"],e):e(t.VueDatetime=t.VueDatetime||{},t.luxon)}(this,function(t,o){"use strict";var i=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=null),this.flow=t,this.endStatus=e,this.diversionNext=null};function n(t){return t.charAt(0).toUpperCase()+t.slice(1)}function e(t){var e=o.DateTime.fromISO(t).toUTC();return e.isValid?e:null}function a(t,e,i){return t&&i<t||e&&e<i}function r(t){return t<10?"0"+t:t}function m(t){return t.startOf("day")}i.prototype.step=function(t){return this.flow.length>t?this.flow[t]:this.endStatus},i.prototype.first=function(){return this.step(0)},i.prototype.next=function(t){if(this.diversionNext){var e=this.diversionNext;return this.diversionNext=null,e}return this.step(this.flow.indexOf(t)+1)},i.prototype.diversion=function(t){this.diversionNext=t};var s={render:function(){var i=this,t=i.$createElement,n=i._self._c||t;return n("div",{staticClass:"vdatetime-calendar"},[n("div",{staticClass:"vdatetime-calendar__navigation"},[n("div",{staticClass:"vdatetime-calendar__navigation--previous",on:{click:i.previousMonth}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 61.3 102.8"}},[n("path",{attrs:{fill:"none",stroke:"#444","stroke-width":"14","stroke-miterlimit":"10",d:"M56.3 97.8L9.9 51.4 56.3 5"}})])]),i._v(" "),n("div",{staticClass:"vdatetime-calendar__current--month"},[i._v(i._s(i.monthName)+" "+i._s(i.newYear))]),i._v(" "),n("div",{staticClass:"vdatetime-calendar__navigation--next",on:{click:i.nextMonth}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 61.3 102.8"}},[n("path",{attrs:{fill:"none",stroke:"#444","stroke-width":"14","stroke-miterlimit":"10",d:"M56.3 97.8L9.9 51.4 56.3 5"}})])])]),i._v(" "),n("div",{staticClass:"vdatetime-calendar__month"},[i._l(i.weekdays,function(t){return n("div",{staticClass:"vdatetime-calendar__month__weekday"},[i._v(i._s(t))])}),i._v(" "),i._l(i.days,function(e){return n("div",{staticClass:"vdatetime-calendar__month__day",class:{"vdatetime-calendar__month__day--selected":e.selected,"vdatetime-calendar__month__day--disabled":e.disabled},on:{click:function(t){i.selectDay(e)}}},[n("span",[n("span",[i._v(i._s(e.number))])])])})],2)])},staticRenderFns:[],props:{year:{type:Number,required:!0},month:{type:Number,required:!0},day:{type:Number,default:null},disabled:{type:Array},minDate:{type:o.DateTime,default:null},maxDate:{type:o.DateTime,default:null},weekStart:{type:Number,default:1}},data:function(){return{newDate:o.DateTime.fromObject({year:this.year,month:this.month,timeZone:"UTC"}),weekdays:function(t){--t<0&&(t=6);var e=o.Info.weekdays("short").map(function(t){return n(t)});return e=e.concat(e.splice(0,t))}(this.weekStart),months:o.Info.months().map(function(t){return n(t)})}},computed:{newYear:function(){return this.newDate.year},newMonth:function(){return this.newDate.month},monthName:function(){return this.months[this.newMonth-1]},days:function(){var t,e,i,n,a,u=this;return(t=this.newYear,e=this.newMonth,i=this.weekStart,n=o.DateTime.local(t,e,1),a=n.weekday-i,a<0&&(a+=7),new Array(n.daysInMonth+a).fill(null).map(function(t,e){return e+1<=a?null:e+1-a})).map(function(t){return{number:t,selected:t&&u.year===u.newYear&&u.month===u.newMonth&&u.day===t,disabled:!t||(e=u.minDate,i=u.maxDate,n=u.newYear,a=u.newMonth,r=t,s=o.DateTime.fromObject({year:n,month:a,day:r}),e=e?m(e):null,i=i?m(i):null,e&&s<e||i&&i<s)};var e,i,n,a,r,s})}},methods:{selectDay:function(t){t.disabled||this.$emit("change",this.newYear,this.newMonth,t.number)},previousMonth:function(){this.newDate=this.newDate.minus({months:1})},nextMonth:function(){this.newDate=this.newDate.plus({months:1})}}},u={render:function(){var i=this,t=i.$createElement,n=i._self._c||t;return n("div",{class:{"vdatetime-time-picker":!0,"vdatetime-time-picker__with-suffix":i.use12Hour}},[n("div",{ref:"hourList",staticClass:"vdatetime-time-picker__list vdatetime-time-picker__list--hours"},i._l(i.hours,function(e){return n("div",{staticClass:"vdatetime-time-picker__item",class:{"vdatetime-time-picker__item--selected":e.selected,"vdatetime-time-picker__item--disabled":e.disabled},on:{click:function(t){i.selectHour(e)}}},[i._v(i._s(i.formatHour(e.number)))])})),i._v(" "),n("div",{ref:"minuteList",staticClass:"vdatetime-time-picker__list vdatetime-time-picker__list--minutes"},i._l(i.minutes,function(e){return n("div",{staticClass:"vdatetime-time-picker__item",class:{"vdatetime-time-picker__item--selected":e.selected,"vdatetime-time-picker__item--disabled":e.disabled},on:{click:function(t){i.selectMinute(e)}}},[i._v(i._s(e.number))])})),i._v(" "),i.use12Hour?n("div",{ref:"suffixList",staticClass:"vdatetime-time-picker__list vdatetime-time-picker__list--suffix"},[n("div",{staticClass:"vdatetime-time-picker__item",class:{"vdatetime-time-picker__item--selected":i.hour<12},on:{click:function(t){i.selectSuffix("am")}}},[i._v("am")]),i._v(" "),n("div",{staticClass:"vdatetime-time-picker__item",class:{"vdatetime-time-picker__item--selected":12<=i.hour},on:{click:function(t){i.selectSuffix("pm")}}},[i._v("pm")])]):i._e()])},staticRenderFns:[],props:{hour:{type:Number,required:!0},minute:{type:Number,required:!0},use12Hour:{type:Boolean,default:!1},hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},minTime:{type:String,default:null},maxTime:{type:String,default:null},startHour:{type:String,default:null},endHour:{type:String,default:null}},computed:{hours:function(){var i,e=this;return(i=this.hourStep,new Array(Math.ceil(24/i)).fill(null).map(function(t,e){return e*i})).filter(function(t){return e.use12Hour?e.hour<12?t<12:12<=t:!e.startHour||!e.endHour||e.checkHour(t)}).map(function(t){return{number:r(t),selected:t===e.hour,disabled:a(e.minHour,e.maxHour,t)}})},minutes:function(){var i,e=this;return(i=this.minuteStep,new Array(Math.ceil(60/i)).fill(null).map(function(t,e){return e*i})).map(function(t){return{number:r(t),selected:t===e.minute,disabled:a(e.minMinute,e.maxMinute,t)}})},minHour:function(){return this.minTime?parseInt(this.minTime.split(":")[0]):null},minMinute:function(){return this.minTime&&this.minHour===this.hour?parseInt(this.minTime.split(":")[1]):null},maxHour:function(){return this.maxTime?parseInt(this.maxTime.split(":")[0]):null},maxMinute:function(){return this.maxTime&&this.maxHour===this.hour?parseInt(this.maxTime.split(":")[1]):null}},methods:{checkHour:function(t){var e,i=parseInt(t);return e=!(i<parseInt(this.startHour)||i>parseInt(this.endHour)),console.log("result: ",e),e},selectHour:function(t){console.log("hour:",t),t.disabled||this.$emit("change",{hour:parseInt(t.number)})},selectMinute:function(t){t.disabled||this.$emit("change",{minute:parseInt(t.number)})},selectSuffix:function(t){"am"===t&&12<=this.hour&&this.$emit("change",{hour:parseInt(this.hour-12),suffixTouched:!0}),"pm"===t&&this.hour<12&&this.$emit("change",{hour:parseInt(this.hour+12),suffixTouched:!0})},formatHour:function(t){var e=Number(t);return this.use12Hour?0===e?12:12<e?e-12:e:t}},mounted:function(){var t=this.$refs.hourList.querySelector(".vdatetime-time-picker__item--selected"),e=this.$refs.minuteList.querySelector(".vdatetime-time-picker__item--selected");this.$refs.hourList.scrollTop=t?t.offsetTop-250:0,this.$refs.minuteList.scrollTop=e?e.offsetTop-250:0}},c={render:function(){var i=this,t=i.$createElement,n=i._self._c||t;return n("div",{staticClass:"vdatetime-year-picker"},[n("div",{ref:"yearList",staticClass:"vdatetime-year-picker__list vdatetime-year-picker__list"},i._l(i.years,function(e){return n("div",{staticClass:"vdatetime-year-picker__item",class:{"vdatetime-year-picker__item--selected":e.selected},on:{click:function(t){i.select(e.number)}}},[i._v(i._s(e.number))])}))])},staticRenderFns:[],props:{year:{type:Number,required:!0}},computed:{years:function(){var i,e=this;return(i=this.year,new Array(201).fill(null).map(function(t,e){return i-100+e})).map(function(t){return{number:t,selected:t===e.year}})}},methods:{select:function(t){this.$emit("change",parseInt(t))},scrollToCurrent:function(){var t=this.$refs.yearList.querySelector(".vdatetime-year-picker__item--selected");this.$refs.yearList.scrollTop=t?t.offsetTop-250:0}},mounted:function(){this.scrollToCurrent()},updated:function(){this.scrollToCurrent()}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vdatetime"},[i("input",e._g(e._b({staticClass:"vdatetime-input",class:e.inputClass,attrs:{type:"text"},domProps:{value:e.inputValue},on:{click:e.open,focus:e.open}},"input",e.$attrs,!1),e.$listeners)),e._v(" "),i("transition-group",{attrs:{name:"vdatetime-fade",tag:"div"}},[e.isOpen?i("div",{key:"overlay",staticClass:"vdatetime-overlay",on:{click:function(t){return t.target!==t.currentTarget?null:e.cancel(t)}}}):e._e(),e._v(" "),e.isOpen?i("datetime-popup",{key:"popup",attrs:{type:e.type,datetime:e.popupDate,phrases:e.phrases,"use12-hour":e.use12Hour,"hour-step":e.hourStep,"minute-step":e.minuteStep,"min-datetime":e.popupMinDatetime,"max-datetime":e.popupMaxDatetime,"start-hour":e.startHour,"end-hour":e.endHour,auto:e.auto,"week-start":e.weekStart},on:{confirm:e.confirm,cancel:e.cancel}}):e._e()],1)],1)},staticRenderFns:[],components:{DatetimePopup:{render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"vdatetime-popup"},[i("div",{staticClass:"vdatetime-popup__header"},[i("div",{staticClass:"vdatetime-popup__year",on:{click:t.showYear}},[t._v(t._s(t.year))]),t._v(" "),i("div",{staticClass:"vdatetime-popup__date"},[t._v(t._s(t.dateFormatted))])]),t._v(" "),i("div",{staticClass:"vdatetime-popup__body"},["year"===t.step?i("datetime-year-picker",{attrs:{year:t.year},on:{change:t.onChangeYear}}):t._e(),t._v(" "),"date"===t.step?i("datetime-calendar",{attrs:{year:t.year,month:t.month,day:t.day,"min-date":t.minDatetime,"max-date":t.maxDatetime,"week-start":t.weekStart},on:{change:t.onChangeDate}}):t._e(),t._v(" "),"time"===t.step?i("datetime-time-picker",{attrs:{hour:t.hour,minute:t.minute,"use12-hour":t.use12Hour,"hour-step":t.hourStep,"start-hour":t.startHour,"end-hour":t.endHour,"minute-step":t.minuteStep,"min-time":t.minTime,"max-time":t.maxTime},on:{change:t.onChangeTime}}):t._e()],1),t._v(" "),i("div",{staticClass:"vdatetime-popup__actions"},[i("div",{staticClass:"vdatetime-popup__actions__button vdatetime-popup__actions__button--cancel",on:{click:t.cancel}},[t._v(t._s(t.phrases.cancel))]),t._v(" "),i("div",{staticClass:"vdatetime-popup__actions__button vdatetime-popup__actions__button--confirm",on:{click:t.confirm}},[t._v(t._s(t.phrases.ok))])])])},staticRenderFns:[],components:{DatetimeCalendar:s,DatetimeTimePicker:u,DatetimeYearPicker:c},props:{datetime:{type:o.DateTime,required:!0},phrases:{type:Object,default:function(){return{cancel:"Cancel",ok:"Ok"}}},type:{type:String,default:"date"},use12Hour:{type:Boolean,default:!1},hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},minDatetime:{type:o.DateTime,default:null},maxDatetime:{type:o.DateTime,default:null},auto:{type:Boolean,default:!1},weekStart:{type:Number,default:1},startHour:{type:String,default:null},endHour:{type:String,default:null}},data:function(){var t=function(t){var e=[];switch(t){case"datetime":e=["date","time"];break;default:e=["date"]}return new i(e,"end")}(this.type);return{newDatetime:this.datetime,flow:t,step:t.first(),timePartsTouched:[]}},created:function(){document.addEventListener("keydown",this.onKeyDown)},beforeDestroy:function(){document.removeEventListener("keydown",this.onKeyDown)},computed:{year:function(){return this.newDatetime.year},month:function(){return this.newDatetime.month},day:function(){return this.newDatetime.day},hour:function(){return this.newDatetime.hour},minute:function(){return this.newDatetime.minute},dateFormatted:function(){return this.newDatetime.toLocaleString({month:"long",day:"numeric"})},minTime:function(){return this.minDatetime&&this.minDatetime.year===this.year&&this.minDatetime.month===this.month&&this.minDatetime.day===this.day?this.minDatetime.toFormat("HH:mm"):null},maxTime:function(){return this.maxDatetime&&this.maxDatetime.year===this.year&&this.maxDatetime.month===this.month&&this.maxDatetime.day===this.day?this.maxDatetime.toFormat("HH:mm"):null}},methods:{nextStep:function(){this.step=this.flow.next(this.step),this.timePartsTouched=[],"end"===this.step&&this.$emit("confirm",this.newDatetime)},showYear:function(){this.step="year",this.flow.diversion("date")},confirm:function(){this.nextStep()},cancel:function(){this.$emit("cancel")},onChangeYear:function(t){this.newDatetime=this.newDatetime.set({year:t}),this.auto&&this.nextStep()},onChangeDate:function(t,e,i){this.newDatetime=this.newDatetime.set({year:t,month:e,day:i}),this.auto&&this.nextStep()},onChangeTime:function(t){var e=t.hour,i=t.minute;t.suffixTouched&&(this.timePartsTouched.suffix=!0),Number.isInteger(e)&&(this.newDatetime=this.newDatetime.set({hour:e}),this.timePartsTouched.hour=!0),Number.isInteger(i)&&(this.newDatetime=this.newDatetime.set({minute:i}),this.timePartsTouched.minute=!0),this.auto&&this.timePartsTouched.hour&&this.timePartsTouched.minute&&(this.timePartsTouched.suffix||!this.use12Hour)&&this.nextStep()},onKeyDown:function(t){switch(t.keyCode){case 27:case 9:this.cancel();break;case 13:this.nextStep()}}}}},props:{value:{type:String},valueZone:{type:String,default:"UTC"},inputClass:{type:String,default:""},zone:{type:String,default:"local"},format:{type:Object,default:null},type:{type:String,default:"date"},phrases:{type:Object,default:function(){return{cancel:"Cancel",ok:"Ok"}}},use12Hour:{type:Boolean,default:!1},hourStep:{type:Number,default:1},minuteStep:{type:Number,default:1},minDatetime:{type:String,default:null},maxDatetime:{type:String,default:null},startHour:{type:String,default:null},endHour:{type:String,default:null},auto:{type:Boolean,default:!1},weekStart:{type:Number,default:function(){return function(){var e;try{e=require("weekstart")}catch(t){e=window.weekstart}var t=e?e.getWeekStartByLocale(o.Settings.defaultLocale):1;return 0===t?7:t}()}}},data:function(){return{isOpen:!1,datetime:e(this.value)}},watch:{value:function(t){this.datetime=e(t)}},created:function(){this.emitInput()},computed:{inputValue:function(){var t=this.format||("date"===this.type?o.DateTime.DATE_MED:o.DateTime.DATETIME_MED);return this.datetime?this.datetime.setZone(this.zone).toLocaleString(t):""},popupDate:function(){return this.datetime?this.datetime.setZone(this.zone):o.DateTime.utc().setZone(this.zone)},popupMinDatetime:function(){return this.minDatetime?o.DateTime.fromISO(this.minDatetime):null},popupMaxDatetime:function(){return this.maxDatetime?o.DateTime.fromISO(this.maxDatetime):null}},methods:{emitInput:function(){var t=this.datetime?this.datetime.setZone(this.valueZone):null;t&&"date"===this.type&&(t=m(this.datetime)),this.$emit("input",t?t.toISO():"")},open:function(t){t.target.blur(),this.isOpen=!0},close:function(){this.isOpen=!1},confirm:function(t){this.datetime=t.toUTC(),this.emitInput(),this.close()},cancel:function(){this.close()}}};function d(t){t.component("datetime",l)}"undefined"!=typeof window&&window.Vue&&window.Vue.use(d);t.default=d,t.Datetime=l,t.version="1.0.0-beta.2",Object.defineProperty(t,"__esModule",{value:!0})});